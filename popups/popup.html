<meta charset="utf-8" />

<style>
  html,
  body {
    min-width: 286px;
    min-height: 33px;
  }

  .container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin-top: 2em;
  }

  .custom-button {
    width: 100%;
    height: 3em;
    line-height: 3em;
    padding: 0 1em;
    text-align: center;
    border-top: 1px solid #c2c2c2;
    background-color: #fff;
    cursor: pointer;
  }

  .custom-button.disabled {
    background-color: #f2f2f2
  }

  .custom-button:not(:disabled):hover {
    background-color: #f2f2f2;
  }

  .custom-button:disabled {
    background-color: #f2f2f2;
    cursor: not-allowed;
  }

  .text-right {
    float: right;
  }
</style>
<h3>🍔 ദി=´∀｀) 햄부기와 친구들</h3>
<smaller>햄부기와 친구들은 여러분의 개인정보를 수집하지 않습니다.</smaller>
<hr />
<h4>주문은 최대 50개까지 가능합니다.</h4>
<div class="container">
  <div id="create-new-bugi" class="custom-button">햄부기 주문</div>
  <div id="destroy-bugi" class="custom-button">햄부기 폐기</div>
  <div id="destroy-all-bugis" class="custom-button">햄부기 전량 폐기</div>
  <div id="create-new-french-fries" class="custom-button">푸라이 주문</div>
  <div id="destroy-french-fries" class="custom-button">푸라이 폐기</div>
  <div id="destroy-all-french-fries" class="custom-button">푸라이 전량 폐기</div>
</div>
<style>
  .section {
    width: 95%;
    margin-top: 1em;
    border: 1px solid #e5e5e5;
    border-radius: 6px;
    padding: 0.75em;
    background: #fff;
  }

  .row {
    display: flex;
    gap: 0.5em;
    width: 100%;
    margin-bottom: 0.5em;
    align-items: center;
  }

  .row>* {
    flex: 1;
  }

  input[type="file"] {
    width: 100%;
  }

  input[type="password"],
  input[type="text"] {
    width: 100%;
    box-sizing: border-box;
  }

  canvas {
    border: 1px dashed #c2c2c2;
    background: #fafafa;
  }

  .grid-preview {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 6px;
    width: 100%;
  }
</style>
<div class="section" id="new-friend-section">
  <h4>🧪 새 친구 생성하기 (실험적 기능)</h4>
  <div class="row">
    <label>레퍼런스 이미지 업로드</label>
  </div>
  <div class="row">
    <input id="reference-file" type="file" accept="image/*" />
  </div>
  <div class="row">
    <label>Gemini API Key</label>
  </div>
  <div class="row">
    <input id="api-key" type="password" placeholder="API Key 입력" />
  </div>
  <div class="row">
    <label><input type="checkbox" id="remember-key" /> API Key 저장 (Local)</label>
  </div>
  <div class="row">
    <label>추가 프롬프트 (선택)</label>
  </div>
  <div class="row">
    <input id="prompt" type="text" placeholder="예: 빨간 모자를 쓴 귀여운 캐릭터" />
  </div>
  <div class="row">
    <div style="display:flex; gap:8px; width:100%">
      <div style="flex:1">
        <div style="font-size: 0.9em; margin-bottom: 4px;">업로드 미리보기</div>
        <canvas id="ref-canvas" width="96" height="96"></canvas>
      </div>
      <div style="flex:1">
        <div style="font-size: 0.9em; margin-bottom: 4px;">시트 미리보기</div>
        <canvas id="sheet-canvas" width="240" height="48"></canvas>
      </div>
    </div>
  </div>
  <div class="row">
    <div style="font-size: 0.9em; margin-bottom: 4px;">프레임 미리보기</div>
  </div>
  <div class="row">
    <div class="grid-preview">
      <canvas id="frame-0" width="48" height="48"></canvas>
      <canvas id="frame-1" width="48" height="48"></canvas>
      <canvas id="frame-2" width="48" height="48"></canvas>
      <canvas id="frame-3" width="48" height="48"></canvas>
      <canvas id="frame-4" width="48" height="48"></canvas>
    </div>
  </div>
  <div class="row">
    <button id="btn-generate" class="custom-button">AI로 스프라이트 생성</button>
  </div>
  <hr />
  <div class="row" style="margin-top: 1em;">
    <label>Remove.bg API Key (배경 제거용)</label>
  </div>
  <div class="row">
    <input id="removebg-api-key" type="password" placeholder="remove.bg 사이트의 API Key 입력" />
  </div>
  <div class="row">
    <span style="color: #666;"><small><a href="https://www.remove.bg/api" target="_blank">remove.bg API Key 발급</a>문서를
        참고하세요.</small></span>
  </div>
  <div class="row">
    <label><input type="checkbox" id="remember-removebg-key" /> API Key 저장 (Local)</label>
  </div>
  <div class="row">
    <button id="btn-remove-background" class="custom-button" disabled style="opacity: 0.5;">배경 제거 🎨</button>
  </div>
  <div class="row">
    <button id="btn-download-sprite" class="custom-button" disabled style="opacity: 0.5;">스프라이트 다운로드 💾</button>
  </div>
  <div class="row">
    <span id="status-text" style="font-size: 0.9em; color: #666;"></span>
  </div>
  <div class="row" style="margin-top: 1em;">
    <span style="color: #666;"><small>API Key에 "hamburger"를 입력해보세요. 운이 좋다면 API Key 없이도 AI생성/배경제거 기능을 사용할 수
        있습니다.</small></span>
  </div>
</div>
<div class="container">
  <div id="create-new-friend" class="custom-button" disabled style="opacity: 0.5;">새 친구 생성 🎉</div>
  <div id="destroy-new-friend" class="custom-button">새 친구 제거</div>
  <div id="destroy-all-new-friends" class="custom-button">새 친구 모두 제거</div>
</div>
<script src="../lib/nanobanana.js"></script>
<script src="../lib/spritesheet.js"></script>
<script src="popup.js"></script>
